
<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Recepção – Queimadas Telemedicina</title>
  <style>
    :root {--bg:#f6f9fc;--primary:#073b6d;--accent:#0b7a3b;--card:#fff;--shadow:0 6px 24px rgba(0,0,0,.08);--radius:18px;--muted:#64748b;}
    * {box-sizing:border-box;-webkit-font-smoothing:antialiased}
    body {margin:0;font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;background:var(--bg);color:#0f172a}
    .app {min-height:100dvh;display:flex;flex-direction:column}
    header.topo {position:sticky;top:0;z-index:10;background:#0b2f57;color:#fff;display:flex;flex-direction:column;align-items:center;gap:6px;padding:10px 14px;box-shadow:var(--shadow);}
    header .logo-wrap {display:flex;flex-direction:column;align-items:center;gap:4px}
    header .logo-wrap img {height:42px;max-width:80vw;object-fit:contain}
    header .logo-wrap .subtitle {font-size:12px;opacity:.9;letter-spacing:.2px}
    .content {flex:1;display:flex;flex-direction:column;padding:12px;gap:10px}
    .card {background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px}
    .chat {flex:1;display:flex;flex-direction:column;gap:10px;overflow:auto;scroll-behavior:smooth;padding-bottom:10px}
    .bubble {max-width:85%;padding:10px 12px;border-radius:14px;line-height:1.35;font-size:15px;word-wrap:break-word;box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .from-bot {background:#ecf4ff;border:1px solid #cfe3ff;align-self:flex-start}
    .from-user {background:#d1fae5;border:1px solid #a7f3d0;align-self:flex-end}
    .typing {opacity:.75;font-style:italic}
    .input-row {position:sticky;bottom:0;display:flex;gap:8px;padding:10px;background:linear-gradient(180deg,transparent,rgba(246,249,252,.9) 25%, rgba(246,249,252,1) 70%)}
    .text-in {flex:1;border:1px solid #dbe5f0;border-radius:12px;padding:12px 12px;font-size:16px;background:#fff}
    .btn {background:#0b7a3b;border:none;color:#fff;padding:12px 16px;border-radius:12px;font-weight:600;font-size:15px}
    .btn:disabled {opacity:.6}
    .footer-logo {position:sticky;bottom:0;display:flex;justify-content:center;padding:8px 0 14px}
    .footer-logo img {max-width:240px;width:66vw;height:auto}
    .countdown {font-variant-numeric:tabular-nums;font-weight:700;color:#0b7a3b}
    @media (min-width:768px) {.bubble{font-size:16px}}
  </style>
</head>
<body><div class="app">
  <header class="topo">
    <div class="logo-wrap">
      <img src="prefeitura-queimadas.jpg" alt="Prefeitura de Queimadas">
      <div class="subtitle">Queimadas Telemedicina</div>
    </div>
  </header>

  <div class="content">
    <div id="chat" class="chat"></div>
    <div id="box-esps" class="card" style="padding:8px;display:none;">
      <div style="font-weight:700;margin:6px 8px;">Escolha a especialidade</div>
      <div id="grid-esps" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
        <button class="esp" data-esp="Clínico Geral"><strong>Clínico Geral</strong><span>atendimento geral</span></button>
<button class="esp" data-esp="Medicina de Família e Comunidade"><strong>Medicina de Família e Comunidade</strong><span>cuidado integral / doenças comuns</span></button>
<button class="esp" data-esp="Pediatra"><strong>Pediatra</strong><span>crianças</span></button>
<button class="esp" data-esp="Neonatologista"><strong>Neonatologista</strong><span>recém-nascidos</span></button>
<button class="esp" data-esp="Geriatra"><strong>Geriatra</strong><span>idosos</span></button>
<button class="esp" data-esp="Ginecologista/Obstetra"><strong>Ginecologista/Obstetra</strong><span>saúde feminina / gravidez</span></button>
<button class="esp" data-esp="Urologista"><strong>Urologista</strong><span>sistema urinário / próstata</span></button>
<button class="esp" data-esp="Cardiologista"><strong>Cardiologista</strong><span>coração</span></button>
<button class="esp" data-esp="Cardiopediatra"><strong>Cardiopediatra</strong><span>coração infantil</span></button>
<button class="esp" data-esp="Endocrinologista"><strong>Endocrinologista</strong><span>hormônios / tireoide / diabetes</span></button>
<button class="esp" data-esp="Endocrinopediatra"><strong>Endocrinopediatra</strong><span>hormônios infantis</span></button>
<button class="esp" data-esp="Ortopedista"><strong>Ortopedista</strong><span>ossos / articulações / coluna</span></button>
<button class="esp" data-esp="Reumatologista"><strong>Reumatologista</strong><span>doenças autoimunes / articulações</span></button>
<button class="esp" data-esp="Dermatologista"><strong>Dermatologista</strong><span>pele / cabelo / unhas</span></button>
<button class="esp" data-esp="Psiquiatra"><strong>Psiquiatra</strong><span>saúde mental</span></button>
<button class="esp" data-esp="Psicólogo"><strong>Psicólogo</strong><span>apoio emocional</span></button>
<button class="esp" data-esp="Neurologista"><strong>Neurologista</strong><span>cérebro / nervos</span></button>
<button class="esp" data-esp="Oftalmologista"><strong>Oftalmologista</strong><span>olhos / visão</span></button>
<button class="esp" data-esp="Otorrinolaringologista"><strong>Otorrinolaringologista</strong><span>ouvido / nariz / garganta</span></button>
<button class="esp" data-esp="Proctologista"><strong>Proctologista</strong><span>reto / ânus / hemorroidas</span></button>
<button class="esp" data-esp="Gastroenterologista"><strong>Gastroenterologista</strong><span>estômago / intestinos</span></button>
<button class="esp" data-esp="Hepatologista"><strong>Hepatologista</strong><span>fígado</span></button>
<button class="esp" data-esp="Nefrologista"><strong>Nefrologista</strong><span>rins</span></button>
<button class="esp" data-esp="Pneumologista"><strong>Pneumologista</strong><span>pulmões / respiração</span></button>
<button class="esp" data-esp="Hematologista"><strong>Hematologista</strong><span>sangue</span></button>
<button class="esp" data-esp="Infectologista"><strong>Infectologista</strong><span>infecções / doenças transmissíveis</span></button>
<button class="esp" data-esp="Alergologista/Imunologista"><strong>Alergologista/Imunologista</strong><span>alergias / imunidade</span></button>
<button class="esp" data-esp="Angiologista"><strong>Angiologista</strong><span>veias / circulação</span></button>
<button class="esp" data-esp="Oncologista"><strong>Oncologista</strong><span>câncer</span></button>
<button class="esp" data-esp="Medicina do Trabalho"><strong>Medicina do Trabalho</strong><span>saúde ocupacional / atestados</span></button>
<button class="esp" data-esp="Nutricionista"><strong>Nutricionista</strong><span>dieta / planejamento alimentar</span></button>
<button class="esp" data-esp="Fonoaudiólogo"><strong>Fonoaudiólogo</strong><span>fala / deglutição / audição</span></button>
<button class="esp" data-esp="Fisioterapeuta"><strong>Fisioterapeuta</strong><span>reabilitação física</span></button>
      </div>
    </div>
    <div id="box-lei" class="card" style="font-size:12px;color:#334155;line-height:1.35;">
      <strong>Telemedicina (Lei 13.989/2020 + Portarias)</strong> — consultas a distância, registro em prontuário, sigilo e consentimento informado. Receitas digitais com assinatura eletrônica conforme normas brasileiras.
    </div>
  </div>
  <div class="input-row">
    <input id="msg" class="text-in" placeholder="Escreva sua mensagem…">
    <button id="send" class="btn">Enviar</button>
  </div>

  <style>
    #grid-esps .esp{display:flex;flex-direction:column;align-items:flex-start;gap:2px;padding:10px;border:1px solid #dbe5f0;border-radius:12px;background:#fff;text-align:left;font-size:14px}
    #grid-esps .esp span{color:var(--muted);font-size:12px}
  </style>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('msg');
    const btn = document.getElementById('send');
    const boxEsps = document.getElementById('box-esps');
    const API_BASE = localStorage.getItem('API_BASE') || 'https://remedy-queimadas-api.onrender.com';

    const addBubble = (t, who='bot', extraClass='')=>{ const b=document.createElement('div'); b.className='bubble '+(who==='bot'?'from-bot':'from-user')+' '+extraClass; b.textContent=t; chat.appendChild(b); chat.scrollTop=chat.scrollHeight; return b; };
    const nonce = ()=> Math.random().toString(36).slice(2)+Date.now();

    function botTypeThen(text, msThink=900, msType=800) { 
      const tmp = addBubble('Recepção digitando…','bot','typing');
      setTimeout(()=>{ tmp.textContent='Recepção digitando…'; setTimeout(()=>{ tmp.remove(); addBubble(text,'bot'); }, msType); }, msThink);
    }

    // Boas-vindas + só então exibir especialidades
    botTypeThen('Bem-vindo(a) à Queimadas Telemedicina!');
    setTimeout(()=> botTypeThen('Descreva brevemente sua demanda e, em seguida, escolha a especialidade para que eu direcione você ao médico adequado.'), 2000);
    setTimeout(()=> boxEsps.style.display='block', 3600);

    document.querySelectorAll('#grid-esps .esp').forEach(b=>b.addEventListener('click',()=>{ 
      const esp=b.dataset.esp;
      addBubble('Especialidade escolhida: '+esp,'user');
      boxEsps.style.display='none';

      // Mensagem de encaminhamento e cronômetro aleatório (1 a 5 minutos)
      const minutos = Math.floor(Math.random()*5)+1;
      let restante = minutos*60;
      botTypeThen('Certo. Vou encaminhar você para o médico de '+esp+'. Tempo estimado: '+minutos+' min.');
      const cnt = addBubble('Aguardando atendimento: '+minutos+':00','bot','countdown');
      const id = setInterval(()=>{ 
        restante--; 
        const mm = String(Math.floor(restante/60)).padStart(1,'0');
        const ss = String(restante%60).padStart(2,'0');
        cnt.textContent = 'Aguardando atendimento: '+mm+':'+ss;
        if(restante<=0) { clearInterval(id); encaminhar(esp); }
      }, 1000);
      
      function encaminhar(espSel){ 
        const n=nonce(); sessionStorage.setItem('reimed_nonce',n); sessionStorage.setItem('reimed_esp',espSel);
        const url=new URL('paciente.html',location.href); url.searchParams.set('especialidade',espSel); url.searchParams.set('nonce',n); location.href=url.toString();
      }
    }));

    btn.addEventListener('click',()=>{ 
      if(!input.value.trim()) return; 
      addBubble(input.value.trim(),'user'); 
      input.value=''; 
    });
  </script>

  <div class="footer-logo">
    <img src="atende-mais.png" alt="Atende+">
  </div>
</div></body></html>

