<!doctype html><html lang="pt-BR"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Redefinir senha – Queimadas Telemedicina</title>
<link rel="stylesheet" href="style.css"><style>
.form{ max-width:440px; margin:20px auto; background:#fff; border:1px solid #e6ebf5; padding:16px; border-radius:12px; }
.form h2{ margin:0 0 10px; }
.form label{ display:block; margin:10px 0 4px; font-weight:600; }
.form input{ width:100%; padding:12px 14px; border:1px solid #cfd8ea; border-radius:10px; font-size:16px; }
.form button{ margin-top:12px; background:#0e8240; color:#fff; border:none; padding:12px 16px; border-radius:10px; font-weight:700; width:100%; }
.form .alt{ margin-top:10px; text-align:center; }
</style>
<style>.toplink{position:absolute;right:16px;top:12px;font-weight:700} .toplink a{color:#0e8240;text-decoration:none}</style>
<style>.sitefoot{max-width:920px;margin:30px auto 20px;text-align:center;color:#6b7899;font-size:12px} .sitefoot a{color:#6b7899;text-decoration:none}</style>
</head><body>
<header><img class="qbanner" src="prefeitura-queimadas.jpg" alt="Prefeitura de Queimadas"><h1>Queimadas Telemedicina</h1><nav class="toplink"><a href="history.html" id="lkHist" style="display:none">Meu histórico</a> &nbsp;•&nbsp; <a href="#" id="lkLogout" style="display:none">Sair</a></nav></header>
<main>
  <form class="form" id="f">
    <h2>Redefinir senha</h2>
    <label>Nova senha</label><input id="pw" type="password" autocomplete="new-password">
    <button type="submit">Salvar nova senha</button>
    <div class="alt"><a href="login.html">Entrar</a></div>
  </form>
</main>

<script type="module">
try{
  const el = document.getElementById('lkHist');
  const { isAuthed } = await import('./auth.js');
  function update(){ if(!el) return; if(isAuthed()){ el.style.removeProperty('display'); } else { el.style.display='none'; } }
  update();
  window.addEventListener('auth-changed', update);
  window.addEventListener('storage', (e)=>{ if(e.key==='AUTH_TOKEN') update(); });
}catch(_e){}
</script>



<script type="module">
try{
  const lkHist = document.getElementById('lkHist');
  const lkLogout = document.getElementById('lkLogout');
  const mod = await import('./auth.js');
  const { isAuthed, logout } = mod;
  function update(){
    const authed = isAuthed();
    if(lkHist){ authed ? lkHist.style.removeProperty('display') : (lkHist.style.display='none'); }
    if(lkLogout){ authed ? lkLogout.style.removeProperty('display') : (lkLogout.style.display='none'); }
  }
  update();
  window.addEventListener('auth-changed', update);
  window.addEventListener('storage', (e)=>{ if(e.key==='AUTH_TOKEN') update(); });
  if(lkLogout){
    lkLogout.addEventListener('click', (e)=>{
      e.preventDefault();
      logout();
      // Se estiver em página pública, mantém; se estiver em página privada, manda para login.
      const priv = /receptionist\.html|paciente\.html|medico\.html|history\.html/i.test(location.pathname);
      if(priv) location.replace('login.html'); else update();
    });
  }
}catch(_e){}
</script>

</body></html>